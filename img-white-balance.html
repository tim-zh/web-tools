<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>image converter (svg to png)</title>
</head>
<body>
<input type="file" accept="image/*"><br>
<canvas id="original"></canvas>
<a id="save">save</a><br>
<script>
  const canvas = document.getElementById("original");
  document.querySelector("input[type=file]").onchange = function () {
    const img = new Image();
    const file = this.files[0];
    img.file = file;
    const reader = new FileReader();
    reader.onload = e => {
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
    img.onload = () => {
      canvas.width = img.width;
      canvas.height = img.height;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0);
      canvas.onclick = e => {
        const bounding = canvas.getBoundingClientRect();
        const x = e.clientX - bounding.left;
        const y = e.clientY - bounding.top;
        const whitePoint = ctx.getImageData(x, y, 1, 1).data;

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const data = imageData.data;
        for (let i = 0; i < data.length; i += 4) {
          data[i] += 255 - whitePoint[0]; //r
          data[i + 1] += 255 - whitePoint[1]; //g
          data[i + 2] += 255 - whitePoint[2]; //b
        }
        ctx.putImageData(imageData, 0, 0);
        document.getElementById("save").setAttribute("download", document.querySelector("input[type=file]").files[0].name);
        document.getElementById("save").setAttribute("href", canvas.toDataURL("image/png"));
      };
    };
  };
</script>
</body>
</html>
